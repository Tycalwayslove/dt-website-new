{"version":3,"file":"Contact-68ab046d.js","sources":["../../src/utils/tencentMap.ts","../../src/pages/Contact.vue"],"sourcesContent":["import type { Ref } from 'vue'\n\ntype ContainerLike = string | HTMLElement | Ref<HTMLElement | null> | Ref<HTMLDivElement | null>\n\nexport interface InitMapOptions {\n  container: ContainerLike\n  address: string\n  city?: string\n  zoom?: number\n  markerTitle?: string\n}\n\nexport interface InitMapResult {\n  map: any\n  marker: any\n  infoWindow: any\n  location: { lat: number; lng: number }\n}\n\nconst resolveContainer = (container: ContainerLike): HTMLElement | null => {\n  if (typeof container === 'string') {\n    return document.getElementById(container)\n  }\n  if (container && typeof (container as any).value !== 'undefined') {\n    return (container as Ref<HTMLElement | null>).value\n  }\n  return container as HTMLElement | null\n}\n\nconst loadTMapScript = (key: string) => {\n  return new Promise<void>((resolve, reject) => {\n    if ((window as any).TMap) {\n      resolve()\n      return\n    }\n    const existing = document.getElementById('qqmap-script')\n    if (existing) {\n      existing.addEventListener('load', () => resolve())\n      existing.addEventListener('error', () => reject(new Error('QQ Map script failed to load')))\n      return\n    }\n    const script = document.createElement('script')\n    script.id = 'qqmap-script'\n    script.src = `https://map.qq.com/api/gljs?v=1.exp&key=${key}`\n    script.async = true\n    script.onload = () => resolve()\n    script.onerror = () => reject(new Error('QQ Map script failed to load'))\n    document.head.appendChild(script)\n  })\n}\n\nconst searchPOI = async (key: string, address: string, city?: string) => {\n  const boundary = city ? `region(${encodeURIComponent(city)},0)` : 'nearby(22.53318,113.93042,10000)'\n  const url = `https://apis.map.qq.com/ws/place/v1/search?keyword=${encodeURIComponent(address)}&boundary=${boundary}&key=${key}`\n  const resp = await fetch(url)\n  const data = await resp.json()\n  if (data && data.status === 0 && Array.isArray(data.data) && data.data.length > 0) {\n    const best = data.data.find((d: any) => /科兴科学园/i.test(`${d.title} ${d.address || ''}`)) || data.data[0]\n    return best\n  }\n  return null\n}\n\nconst geocode = async (key: string, address: string, city?: string) => {\n  const url = `https://apis.map.qq.com/ws/geocoder/v1/?address=${encodeURIComponent(address)}&key=${key}` +\n    (city ? `&region=${encodeURIComponent(city)}` : '')\n  const resp = await fetch(url)\n  const data = await resp.json()\n  if (data && data.status === 0 && data.result?.location) {\n    return data.result\n  }\n  return null\n}\n\nexport async function initTencentMap(options: InitMapOptions): Promise<InitMapResult> {\n  const key = (import.meta as any).env?.VITE_TENCENT_MAP_KEY\n  if (!key) throw new Error('Missing VITE_TENCENT_MAP_KEY in environment')\n\n  await loadTMapScript(key)\n  const TMap = (window as any).TMap\n  const el = resolveContainer(options.container)\n  if (!el) throw new Error('Map container not found')\n\n  const center = new TMap.LatLng(22.53318, 113.93042)\n  const map = new TMap.Map(el, { center, zoom: options.zoom ?? 16 })\n\n  // Prefer POI search, fallback to geocoder\n  let lat = center.lat\n  let lng = center.lng\n  let title = options.markerTitle || '公司位置'\n  let addressText = options.address\n\n  const poi = await searchPOI(key, options.address, options.city)\n  if (poi && poi.location) {\n    lat = poi.location.lat\n    lng = poi.location.lng\n    title = poi.title || title\n    addressText = poi.address || addressText\n  } else {\n    const geo = await geocode(key, options.address, options.city)\n    if (geo?.location) {\n      lat = geo.location.lat\n      lng = geo.location.lng\n    }\n  }\n\n  const loc = new TMap.LatLng(lat, lng)\n  map.setCenter(loc)\n\n  const marker = new TMap.MultiMarker({\n    map,\n    styles: {\n      company: new TMap.MarkerStyle({ width: 28, height: 42, anchor: { x: 14, y: 42 } }),\n    },\n    geometries: [\n      { id: 'company', styleId: 'company', position: loc, properties: { title, address: addressText } },\n    ],\n  })\n\n  const infoWindow = new TMap.InfoWindow({ map, position: loc, content: `<div style=\\\"font-size:14px;\\\"><strong>${title}</strong><br/>${addressText}</div>` })\n  infoWindow.close()\n  marker.on('click', (evt: any) => {\n    const pos = evt.geometry.position\n    infoWindow.setPosition(pos)\n    infoWindow.open()\n  })\n\n  return { map, marker, infoWindow, location: { lat, lng } }\n}","<template>\n  <div class=\"bg-white\">\n    <!-- PC端布局：背景图容器（宽度铺满，高度580px） -->\n    <section class=\"container mx-auto px-20 lg:px-20 py-20 hidden md:block\">\n      <div\n        v-fade-in-up=\"{ delay: 300 }\"\n        class=\"w-full h-[580px] relative rounded-2xl overflow-hidden\"\n        :style=\"{\n          backgroundImage: `url(${bg})`,\n          backgroundSize: 'cover',\n          backgroundPosition: 'center',\n        }\"\n      >\n        <!-- 内容栅格：左地图 右公司信息；屏幕较小时扩大地图占比 -->\n        <div\n          class=\"absolute inset-0 grid md:grid-cols-[6fr_3fr] lg:grid-cols-[3fr_2fr] xl:grid-cols-[1fr_1fr] gap-8 items-center p-20\"\n        >\n          <!-- 左侧：地图显示区域 -->\n          <div v-fade-in-up=\"{ delay: 500 }\" class=\"h-full\">\n            <div\n              ref=\"mapContainerRef\"\n              class=\"w-full h-full rounded-xl overflow-hidden border border-gray-200\"\n            ></div>\n          </div>\n\n          <!-- 右侧：公司信息（四行文案） -->\n          <div\n            v-fade-in-up=\"{ delay: 800 }\"\n            class=\"flex flex-col justify-center space-y-3 text-white pl-10\"\n          >\n            <!-- 第一行：联系我们 -->\n            <h2 class=\"text-3xl font-semibold\">联系我们</h2>\n            <!-- 第二行：AI 智能体（喵呜AI） -->\n            <p class=\"text-xl\">喵呜AI</p>\n            <!-- 第三行：地址（图标+地址） -->\n            <p class=\"text-base mt-2 flex items-center\">\n              <img :src=\"locationImg\" alt=\"地址图标\" class=\"w-[17px] h-[20px] mr-2\" />\n              深圳市南山区粤海街道科兴科学园A1-10\n            </p>\n            <!-- 第四行：邮箱（图标+email） -->\n            <p class=\"text-base mt-2 flex items-center\">\n              <img :src=\"emailImg\" alt=\"邮箱图标\" class=\"w-[18px] h-[13px] mr-2\" />\n              service@meupop.com\n            </p>\n          </div>\n        </div>\n      </div>\n    </section>\n\n    <!-- 移动端布局：仅在小屏显示 -->\n    <section v-fade-in-up=\"{ delay: 500 }\" class=\"container block md:hidden px-4 py-8 space-y-4\">\n      <!-- 顶部背景图：全屏自适应，高度300px，文案置于中间 -->\n      <div class=\"w-full relative\">\n        <img :src=\"bg\" alt=\"联系背景图\" class=\"w-full h-[300px] object-cover rounded-2xl\" />\n        <div class=\"absolute inset-0 flex items-center justify-center\">\n          <div class=\"px-6 py-4 bg-black/40 rounded-2xl text-center backdrop-blur-sm\">\n            <h2 class=\"text-2xl font-semibold text-white\">联系我们</h2>\n            <p class=\"text-base text-white\">喵呜AI</p>\n            <div class=\"mt-2 space-y-2\">\n              <p class=\"text-base text-white flex items-center justify-center\">\n                <img :src=\"locationImg\" alt=\"地址图标\" class=\"w-[17px] h-[20px] mr-2\" />\n                深圳市南山区粤海街道科兴科学园A1-10\n              </p>\n              <p class=\"text-base text-white flex items-center justify-center\">\n                <img :src=\"emailImg\" alt=\"邮箱图标\" class=\"w-[18px] h-[13px] mr-2\" />\n                service@meupop.com\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 移动端：地图显示容器 -->\n      <div class=\"w-full h-[260px] rounded-2xl overflow-hidden border border-gray-200\">\n        <div ref=\"mobileMapContainerRef\" class=\"w-full h-full\"></div>\n      </div>\n\n      <!-- 地址信息与邮箱已置于顶部背景图的中间文案中 -->\n    </section>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport bg from '@/assets/img/contact-bg.png'\nimport emailImg from '@/assets/img/contact-email.png'\nimport locationImg from '@/assets/img/contact-location.png'\nimport { initTencentMap } from '@/utils/tencentMap'\nimport { nextTick, onMounted, onUnmounted, ref } from 'vue'\n\nconst COMPANY_ADDRESS = '深圳市南山区粤海街道科兴科学园A1-10'\n\nconst mapContainerRef = ref<HTMLDivElement | null>(null)\nconst mobileMapContainerRef = ref<HTMLDivElement | null>(null)\nlet map: any = null\nlet marker: any = null\nlet infoWindow: any = null\nlet onResizeHandler: ((this: Window, ev: UIEvent) => any) | null = null\n\nonMounted(async () => {\n  try {\n    await nextTick()\n\n    const tryInit = async (containerRef: typeof mapContainerRef) => {\n      const el = containerRef.value\n      if (!el) return\n      const style = window.getComputedStyle(el)\n      const rect = el.getBoundingClientRect()\n      const visible =\n        style.display !== 'none' &&\n        style.visibility !== 'hidden' &&\n        rect.width > 0 &&\n        rect.height > 0\n      if (!visible) return\n      const res = await initTencentMap({\n        container: containerRef,\n        address: COMPANY_ADDRESS,\n        city: '深圳市',\n        zoom: 16,\n        markerTitle: '公司位置',\n      })\n      map = res.map\n      marker = res.marker\n      infoWindow = res.infoWindow\n    }\n\n    // 仅在容器可见且有尺寸时初始化，避免 far <= 0 错误\n    await tryInit(mapContainerRef)\n    await tryInit(mobileMapContainerRef)\n\n    const onResize = () => {\n      try {\n        // 调整当前已初始化地图的尺寸以匹配容器变化\n        if (map && typeof (map as any).resize === 'function') {\n          ;(map as any).resize()\n        }\n      } catch (_) {}\n    }\n    onResizeHandler = onResize\n    window.addEventListener('resize', onResizeHandler)\n    onResize()\n  } catch (e) {\n    console.error('Init map failed:', e)\n  }\n})\n\nonUnmounted(() => {\n  try {\n    if (infoWindow) infoWindow.close()\n  } catch (_) {}\n  infoWindow = null\n  try {\n    if (onResizeHandler) window.removeEventListener('resize', onResizeHandler)\n  } catch (_) {}\n})\n</script>\n"],"names":["resolveContainer","container","loadTMapScript","key","resolve","reject","existing","script","searchPOI","address","city","boundary","url","data","d","geocode","_a","initTencentMap","options","TMap","el","center","map","lat","lng","title","addressText","poi","geo","loc","marker","infoWindow","evt","pos","COMPANY_ADDRESS","mapContainerRef","ref","mobileMapContainerRef","onResizeHandler","onMounted","nextTick","tryInit","containerRef","style","rect","res","onResize","e","onUnmounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_normalizeStyle","_unref","bg","_hoisted_3","_withDirectives","_hoisted_4","_hoisted_5","_cache","_hoisted_6","locationImg","_hoisted_8","emailImg","_hoisted_10","_hoisted_11","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_18","_hoisted_20"],"mappings":"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"}